<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${title} ?: 'Movie Reviews'">Movie Reviews</title>

    <!-- Bootstrap 3 -->
    <link rel="stylesheet" th:href="@{/resources/vendor/bootstrap-3.3.7/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/resources/css/style.css}">

    <!-- jQuery & Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>

    <script th:src="@{/resources/core/jquery.autocomplete.min.js}"></script>


    <!-- Optional: custom CSS -->
    <link rel="stylesheet" th:href="@{/resources/css/searchResults.css}">

    <link rel="icon" th:href="@{/resources/img/MR.png}">
</head>

<body>
<div class="container">
    <!-- Header fragment -->
    <header th:replace="fragments/header :: header"></header>

    <!-- Main content -->
    <main th:replace="index :: body"></main>

    <!-- Footer fragment -->
    <footer th:replace="fragments/footer :: footer"></footer>
</div>

<!-- Autocomplete logic -->
<script th:inline="javascript">
    var link = document.getElementById('searchLink');
    var input = document.getElementById('movieInput');
    if (link && input) {
        input.onchange = input.onkeyup = function() {
            link.href = '/result/' + input.value + '.html';
        };
    }

    $(document).ready(function() {
        $('#movieInput').autocomplete({
            serviceUrl: /*[[@{/getMovies.html}]]*/ '',
            paramName: "movieTitle",
            transformResult: function(response) {
                return {
                    suggestions: $.map($.parseJSON(response), function(item) {
                        return { value: item.movieName, data: item.code };
                    })
                };
            },
            onSelect: function(suggestion) {
                window.location.href = /*[[@{/movie/}]]*/ '' + suggestion.data + '.html';
            }
        });
    });
</script>
</body>
</html>
